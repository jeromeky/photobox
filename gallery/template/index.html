{% extends "skeleton.html" %}

{% block content %}
<script>

$(document).ready(function(){

    Dajaxice.gallery.searchFilesInFolder(refreshImagesAndFolders, {'pathFolder':'{{imagesPath}}'});


});

function ajaxRequestRefreshImagesAndFolders(path){
    Dajaxice.gallery.searchFilesInFolder(refreshImagesAndFolders, {'pathFolder':path});
}

function refreshImagesAndFolders(data){
    $('#folders').html('');
    if(data.folders.length>0){
        $.each(data.folders, function(index, value){
	        folderPath = value.replace(data.currentPath + "/", '');
            $('#folders').append("<li><a href='#' onclick='ajaxRequestRefreshImagesAndFolders(&apos;"+value+"&apos;)'>"+folderPath+"</a></li>");
        });
    }
    $('#images').html('');
    $.each(data.images, function(index, value){
        thumbImage = value.replace('/media/images/normal/','/media/images/thumbnail/');
        $('#images').append("<a href='"+value+"' rel='prettyPhoto[portfolio]'> <img src='"+thumbImage+"'/></a>");
    });
    currentPath = data.currentPath.replace('/', '');
    listPathAriane = currentPath.split('/');
    fileArianePath="";
    $('#filariane').html('');
    $.each(listPathAriane, function(index, value){
	if(index < listPathAriane.length - 1 ){
	    fileArianePath+="/" + value;
	    $('#filariane').append("<a href='#' onclick='ajaxRequestRefreshImagesAndFolders(&apos;"+fileArianePath+"&apos;)'>"+value+"</a>").append(" / ");
	}else 
	    $('#filariane').append(" "+value);
    });

  $(".portfolio a[rel^='prettyPhoto']").prettyPhoto({
    theme:'light_square',
    autoplay_slideshow: false,
    overlay_gallery: false
  });

}
</script>
<div id="filariane"></div>
<ul id="folders"></ul>
<div id="images" class="portfolio"></div>
{% endblock %}
